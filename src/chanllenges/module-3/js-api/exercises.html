<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bahia</title>
</head>

<body>
  <canvas id="myChart"></canvas>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    async function getMonedas() {
      const endpoint = "https://api.gael.cloud/general/public/monedas";
      const res = await fetch(endpoint);
      const monedas = await res.json();
      return monedas;
    }

    function prepararConfiguracionParaLaGrafica(monedas) {
      // creamos la variables necesarias para el objeto de configuracion 
      const tipoDeGrafica = "line";
      const nombresDeLasMonedas = monedas.map((monedas) => monedas.Codigo);
      const titulo = "Monedas";
      const colorDeLinea = "red";
      const valores = monedas.map((monedas) => {
        const valor = monedas.Valor.replace(",", ".");
        return Number(valor);
      });

      // Creamos el objeto de configuraci√≥n usando las variables anteriores
      const config = {
        type: tipoDeGrafica,
        data: {
          labels: nombresDeLasMonedas,
          datasets: [
            {
              label: titulo,
              backgroundColor: colorDeLinea,
              data: valores
            }
          ]
        }
      };
      return config;
    }

    async function renderGrafica() {
      const monedas = await getMonedas();
      const config = prepararConfiguracionParaLaGrafica(monedas);
      const chartDOM = document.getElementById("myChart");
      new Chart(chartDOM, config);
    }

    renderGrafica();

  </script>
</body>

</html>