<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">

<head>
    <!-- ogp : Meta Titulo -->
  <meta property="og:title" content="PostgreSQL: CheatSheet">
  <meta property="og:image" content="https://s3-eu-west-1.amazonaws.com/blog.forestadmin.com/2022/05/FA-article-PostgreSQL-cheatsheet--1-.png">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cheatsheet</title>
  <script src="../../index.js" type="module"></script>
  <link rel="stylesheet" href="./highlight/styles/base16/default-dark.min.css">
  <link rel="stylesheet" href="./index.css">
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
  <style>
    h4 {
      margin: 15px 0;
    }
  </style>
</head>

<body class="dark">
  <article class="doc dark">
    <h1>Cheatsheet PostgreSQL</h1>
    <enidev-details data-title="Funciones Matemática" data-lang="postgresql">
      <div class="container">
      <!-- ABS -->
      <p>La función <strong>abs()</strong> nos retorna el valor absoluto</p>
      <div class="highlight">
        <pre><code class="language-postgresql">
SELECT abs(-49);
            </code></pre>
        <custom-button></custom-button>
        <custom-button data-btn="compiler" data-lang="postgresql" data-ext="sql"></custom-button>
      </div>
      <p>La función <strong>cbrt()</strong> nos retorna la raíz cúbica</p>
      <div class="highlight">
        <pre><code class="language-postgresql">
SELECT cbrt(27);
                </code></pre>
        <custom-button></custom-button>
        <custom-button data-btn="compiler" data-lang="postgresql" data-ext="sql"></custom-button>
      </div>
      <p>La función <strong>ceil()</strong> nos retorna el valor entero mayor más cercano</p>
      <div class="highlight">
        <pre><code class="language-postgresql">
SELECT ceil(20.5);
                      </code></pre>
        <custom-button></custom-button>
        <custom-button data-btn="compiler" data-lang="postgresql" data-ext="sql"></custom-button>
      </div>
      <p>La función <strong>random()</strong> nos retorna un valor aleatorio entre 0.0 y 1.0</p>
      <div class="highlight">
        <pre><code class="language-postgresql">
SELECT random();
                            </code></pre>
        <custom-button></custom-button>
        <custom-button data-btn="compiler" data-lang="postgresql" data-ext="sql"></custom-button>
      </div>
<!-- POWER -->
    <p>La función <strong>power(a, b)</strong> nos retorna A elevado a la potencia de B
</p>
      <div class="highlight">
        <pre><code class="language-postgresql">
SELECT power(5, 4);
                            </code></pre>
        <custom-button></custom-button>
        <custom-button data-btn="compiler" data-lang="postgresql" data-ext="sql"></custom-button>
      </div>
<!-- MOD -->
    <p>La función <strong>mod(a, b)</strong> nos retorna el módulo (resto) de la operación de división de A (dividendo) entre B (divisor).
      <div class="highlight">
        <pre><code class="language-postgresql">
SELECT mod(9, 4);
                            </code></pre>
        <custom-button></custom-button>
        <custom-button data-btn="compiler" data-lang="postgresql" data-ext="sql"></custom-button>
      </div>
      </div>
    </enidev-details>
    <enidev-details data-title="Funciones de cadenas" data-lang="postgresql">
      <div class="container">
      <!-- SUBSTRING -->
      <p>La función <strong>substring()</strong> nos permite extraer una subcadena</p>
      <div class="highlight">
        <pre><code class="language-postgresql">
SELECT substring('enidev911' from 2 for 3);
        </code></pre>
        <custom-button></custom-button>
        <custom-button data-btn="compiler" data-lang="postgresql" data-ext="sql"></custom-button>
      </div>
      <!--REVERSE-->
      <p>La función <strong>reverse</strong> nos retorna la cadena en sentido inverso:</p>
      <div class="highlight">
        <pre><code class="language-postgresql">
SELECT reverse('enidev911');
              </code></pre>
        <custom-button data-btn="compiler" data-lang="postgresql" data-ext="sql"></custom-button>
        <custom-button></custom-button>
      </div>
      <!--CHAR_LENGTH-->
      <p>La función <strong>char_length(str)</strong> o <strong>character_length(str)</strong> nos retorna la longitud de la STR:</p>
      <div class="highlight">
        <pre><code class="language-postgresql">
SELECT char_length('enidev911');
      </code></pre>
        <custom-button></custom-button>
        <custom-button data-btn="compiler" data-lang="postgresql" data-ext="sql"></custom-button>
      </div>
      <!--RIGHT-->
      <p>La función <strong>right(str text, n int)</strong> nos retorna los últimos N caracteres de STR:</p>
      <div class="highlight">
        <pre><code class="language-postgresql">
SELECT right('enidev911', 2);
      </code></pre>
        <custom-button></custom-button>
        <custom-button data-btn="compiler" data-lang="postgresql" data-ext="sql"></custom-button>
      </div>
      <!--LEFT-->
      <p>La función <strong>left(str text, n int)</strong> nos retorna los primeros N caracteres de STR:</p>
      <div class="highlight">
        <pre><code class="language-postgresql">
SELECT left('enidev911', 2);
      </code></pre>
        <custom-button></custom-button>
        <custom-button data-btn="compiler" data-lang="postgresql" data-ext="sql"></custom-button>
      </div>
      <!--LTRIM-->
      <p>La función <strong>ltrim(str text [, characters text])</strong> nos retorna el extracto de CHARACTERS de izquierda a derecha de STR:</p>
      <div class="highlight">
        <pre><code class="language-postgresql">
SELECT ltrim('911911911enidev911', '911');
      </code></pre>
        <custom-button></custom-button>
        <custom-button data-btn="compiler" data-lang="postgresql" data-ext="sql"></custom-button>
      </div>
      </div>
    </enidev-details>
    <!-- DDL -->
    <enidev-details data-title="Comandos DDL (Data Definition Language)" data-lang="postgresql">
      <div class="container">
<section>
        <h3>1. CREATE</h3>
            <div class="highlight">
      <pre style="tab-size: 2"><code class="language-postgresql">
-- 1 primera forma (si ejecutamos 2 veces, tendriamos un error) 
CREATE TABLE heros (
  id SERIAL,
  name VARCHAR(50)
);
-- 2 forma (Con la cláusula IF NOT EXISTS evitamos el error)
CREATE TABLE IF NOT EXISTS herosDC (
  id SERIAL,
  name VARCHAR(50)
);
-- mostrar las tablas creadas
\dt
        </code></pre>
      <custom-button></custom-button>
      <custom-button data-btn="compiler" data-lang="postgresql" data-ext="sql"></custom-button>
    </div>      
</section> 
<section>
        <h3>2. ALTER</h3>
            <div class="highlight">
      <pre style="tab-size: 2"><code class="language-postgresql">
-- creamos una tabla 
CREATE TABLE users (
  id SERIAL,
  name VARCHAR(50)
);
-- le añadimos una nueva columna
ALTER TABLE users ADD age INT;
-- describimos la tabla 
\d users
        </code></pre>
      <custom-button></custom-button>
      <custom-button data-btn="compiler" data-lang="postgresql" data-ext="sql"></custom-button>
    </div>      
</section> 
<section>
        <h3>3. TRUNCATE</h3>
            <div class="highlight">
      <pre style="tab-size: 2"><code class="language-postgresql">
-- creamos una tabla 
CREATE TABLE users (
  id SERIAL,
  name VARCHAR(50)
);
-- truncamos la tabla (elimina rápidamente todas las filas o tuplas)
TRUNCATE TABLE users;
--- truncamos la tabla y reiniciamos el secuanciador auto-incrementable "SERIAL"
TRUNCATE TABLE users RESTART IDENTITY;
-- describimos la tabla 
\d users
        </code></pre>
      <custom-button></custom-button>
      <custom-button data-btn="compiler" data-lang="postgresql" data-ext="sql"></custom-button>
    </div>      
</section> 
<section>
        <h3>4. DROP</h3>
            <div class="highlight">
      <pre style="tab-size: 2"><code class="language-postgresql">
-- creamos una tabla 
CREATE TABLE users (
  id SERIAL,
  name VARCHAR(50)
);
-- eliminamos la tabla y con toda su estructura.
DROP TABLE users;
-- describimos la tabla (deberíamos obtener un error: Did not find any relation named "users")
\d users
        </code></pre>
      <custom-button></custom-button>
      <custom-button data-btn="compiler" data-lang="postgresql" data-ext="sql"></custom-button>
    </div>      
</section> 
      </div>
    </enidev-details>
<!-- DML -->
    <enidev-details data-title="Comandos DML (Data Manipulation Language)" data-lang="postgresql">
      <div class="container">
 <section>       
        <h3>1. INSERT</h3>
           <div class="highlight">
      <pre style="tab-size: 2"><code class="language-postgresql">
CREATE TABLE IF NOT EXISTS heros (
  name VARCHAR(50)
);
CREATE TABLE IF NOT EXISTS herosDC (
  name VARCHAR(50)
);
-- 1 primera forma 
INSERT INTO heros (name) VALUES ('black adam');
-- 2 forma (El nombre de la columna es opcional)
INSERT INTO heros VALUES ('thor');
-- 3 forma para múltiples tuplas
INSERT INTO heros VALUES ('superman'), ('aquaman'), ('mera'), ('flash');
-- 4 forma insertar en seleccionar (primero se ejecuta el select, luego el insert)
INSERT INTO heros (name) SELECT ('batman');
-- 5 forma insertar el resultado de una query de una tabla en otra tabla
INSERT INTO herosDC SELECT name FROM heros WHERE name IN ('black adam', 'mera', 'flash');
SELECT name as heros FROM heros;
SELECT name as herosDC FROM herosDC;
        </code></pre>
      <custom-button></custom-button>
      <custom-button data-btn="compiler" data-lang="postgresql" data-ext="sql"></custom-button>
    </div>
</section>
 <section>       
        <h3>2. SELECT</h3>
 <h4>Sintaxis</h4>
<div class="highlight">
<pre style="tab-size: 2"><code class="language-postgresql">
SELECT column1, column2, ...
FROM table_name
[where condition]; 
</code></pre></div>
           <div class="highlight">
      <pre style="tab-size: 2"><code class="language-postgresql">
CREATE TABLE IF NOT EXISTS heros (
  id SERIAL,
  name VARCHAR(50)
);

COPY heros (name) FROM stdin;
afrodita
aquaman
batman
deadman
deadshot
eviless
lex luthor
thor
superman
flash
krypto
joker
\.
-- 1. Seleccionar todos los campos (el comodín * no es recomendado)
SELECT * FROM heros;
-- 2. Seleccionar campos por campo (lo ideal)
SELECT id, name as heros FROM heros;
-- 3. Selccionar campos condicionadamente
SELECT id, name as heros 
FROM heros
WHERE LEFT(name, 1) IN ('a', 'e', 'i', 'o', 'u');
        </code></pre>
      <custom-button></custom-button>
      <custom-button data-btn="compiler" data-lang="postgresql" data-ext="sql"></custom-button>
    </div>
</section>
 <section>       
        <h3>3. UPDATE</h3>
 <h4>Sintaxis</h4>
<div class="highlight">
<pre style="tab-size: 2"><code class="language-postgresql">
UPDATE table_name
SET column1 = value1, column2 = value2, ...
WHERE condition;
</code></pre></div>
           <div class="highlight">
      <pre style="tab-size: 2"><code class="language-postgresql">
CREATE TABLE IF NOT EXISTS heros (
  id SERIAL,
  name VARCHAR(50)
);

COPY heros (name) FROM stdin;
afroman
aquamon
batmin
\.
-- 1. ACTUALIZAMOS el registro 1  
UPDATE heros SET name='afrodita' WHERE name='afroman';
-- 2. ACTUALIZAMOS el registro 2
UPDATE heros SET name='aquaman' WHERE name='aquamon';
-- 3. ACTUALIZAMOS el registro 3
UPDATE heros SET name='batman' WHERE name='batmin';
-- 3. Vemos el cambio 
SELECT id, name as heros FROM heros;
        </code></pre>
      <custom-button></custom-button>
      <custom-button data-btn="compiler" data-lang="postgresql" data-ext="sql"></custom-button>
    </div>
</section>
      </div>
    </enidev-details>
    <!-- <h3>Constraint CHECK</h3>
    <p>
      El <strong>contraint CHECK</strong> nos permite limitar el rango de valores que se puede colocar en una columna.
    </p>
    <h4>Verificar al crear una tabla</h4>
    <p>EL siguiente código SQL crea un <strong>constraint CHECK</strong> en la columna <strong>rol</strong> cuando se
      crea la tabla "Usuarios". El <strong>constraint CHECK</strong> asegura que el rol de un usuario puede ser
      "<strong>usuario</strong>" o "<strong>administrador</strong>", si intentas registrar un valor diferente obtendrá
      un error:</p> -->
    <!--TABLA USUARIOS-->
    <!-- <div class="highlight">
      <pre style="tab-size: 2"><code class="language-postgresql">
CREATE TABLE IF NOT EXISTS usuarios (
  id SERIAL PRIMARY KEY,
  email VARCHAR(50),
  nombre VARCHAR(50),
  apellido VARCHAR(50),
  rol VARCHAR(30),
  CONSTRAINT CHK_ROL CHECK (rol = 'administrador' OR rol='usuario')
);

INSERT INTO usuarios (email, nombre, apellido, rol)
VALUES
('marco@gmail.com', 'marco', 'contreras', 'administrador'),
('felipe@gmail', 'felipe', 'cruz', 'usuario'),
('jorge@gmail', 'jorge', 'molina', 'usuario'),
('mario@gmail', 'mario', 'gutierrez', 'usuario'),
('jonathan@gmail', 'jonathan', 'villarroel', 'usuario');
SELECT * FROM usuarios;
        </code></pre>
      <custom-button></custom-button>
      <custom-button data-btn="compiler" data-lang="postgresql" data-ext="sql"></custom-button>
    </div> -->
  </article>
  <script src="./highlight/highlight.min.js"></script>
  <script>
    hljs.highlightAll()
  </script>

</body>

</html>